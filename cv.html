<!DOCTYPE html>
<html>
<head>
    <title>Générateur de CV</title>
    <meta charset="UTF-8">
    <style>
        .card {
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 10px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div id="cvContainer"></div>

    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script>
        // Fonction pour générer le CV à partir du fichier Excel
        function generateCVFromExcel(data) {
            const workbook = XLSX.read(data, { type: 'array' });
            const worksheet = workbook.Sheets[workbook.SheetNames[0]];
            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, raw: false });

            jsonData.sort((a, b) => new Date(b[0]) - new Date(a[0])); // Tri par ordre décroissant de la date de début

            let cvTemplate = `
            <html>
            <head>
                <title>CV</title>
                <meta charset="UTF-8">
                <style>
                    .card {
                        border: 1px solid #ccc;
                        border-radius: 4px;
                        padding: 10px;
                        margin-bottom: 10px;
                    }
                </style>
            </head>
            <body>
                <h1>Curriculum Vitae</h1>
            `;

            jsonData.forEach((row) => {
                const startDate = new Date(row[0]);
                const endDate = new Date(row[1]);
                const jobTitle = row[2];
                const companyName = row[3];

                const cardTemplate = `
                <div class="card">
                    <h2>${jobTitle}</h2>
                    <h3>${companyName}</h3>
                    <p>${startDate.toLocaleDateString()} - ${endDate.toLocaleDateString()}</p>
                </div>
                `;

                cvTemplate += cardTemplate;
            });

            cvTemplate += `
            </body>
            </html>
            `;

            const cvContainer = document.getElementById('cvContainer');
            cvContainer.innerHTML = cvTemplate;
        }

        // Fonction pour récupérer le fichier Excel et générer le CV
        function generateCVOnLoad() {
            const excelUrl = 'https://raw.githubusercontent.com/SmurfNess/smurfness.github.io/main/assets/xlsx/data.xlsx';

            // Récupérer le fichier Excel via fetch ou toute autre méthode appropriée
            fetch(excelUrl)
                .then(response => response.arrayBuffer())
                .then(arrayBuffer => {
                    // Utilisez les données du fichier Excel ici
                    generateCVFromExcel(arrayBuffer);
                })
                .catch(error => {
                    console.error('Une erreur s\'est produite lors de la récupération du fichier Excel :', error);
                });
        }

        // Appeler la fonction de génération du CV lors du chargement de la page
        window.addEventListener('load', generateCVOnLoad);
    </script>
</body>
</html>
